## ![img](https://cnchen2000.oss-cn-shanghai.aliyuncs.com/img/logo.png)      è®¡ç®—æœºä¸äººå·¥æ™ºèƒ½å­¦é™¢ã€Šäººå·¥æ™ºèƒ½ç¨‹åºè®¾è®¡ã€‹å®éªŒæŠ¥å‘ŠğŸ“

| ä¸“ä¸š                 | å­¦å·                   | å§“å         |
| :------------------- | ---------------------- | ------------ |
| æ•°æ®ç§‘å­¦ä¸å¤§æ•°æ®æŠ€æœ¯ | 2025020213             | å¼ å¯Œæ”¿       |
| **è¯¾ç¨‹åç§°**         | **å®éªŒåç§°**           | **å®Œæˆæ—¥æœŸ** |
| äººå·¥æ™ºèƒ½ç¨‹åºè®¾è®¡     | é«˜é˜¶å‡½æ•°ã€lambdaè¡¨è¾¾å¼ | 2022.03.20   |



[TOC]

## ä¸€ å®éªŒç›®æ ‡

> æè¿°æœ¬æ¬¡å®éªŒæ‰€éœ€å®ç°çš„ç›®æ ‡ï¼Œè¯·æ ¹æ®å®éªŒè¯´æ˜æ–‡æ¡£å¡«å†™ã€‚

ä¾‹å¦‚ï¼š

- æŒæ¡Vs Codeã€githubçš„ä½¿ç”¨ï¼›
- æŒæ¡ç¼–ç¨‹æ–‡æ¡£çš„æ’°å†™æ–¹æ³•ï¼›
- å·©å›ºã€æŒæ¡é«˜é˜¶å‡½æ•°ï¼›	

## äºŒ å®éªŒè¦æ±‚

> å®éªŒå®Œæˆçš„å…·ä½“è¦æ±‚è¯´æ˜ã€‚

- ä¸ªäººç‹¬ç«‹å®Œæˆï¼Œç§¯æåŠ¨æ‰‹ç¼–ç¨‹ï¼›
- é¼“åŠ±ä¸åŒå­¦äº¤æµï¼Œä½†ä¸èƒ½æŠ„è¢­æºç ï¼›
- èƒ½å®Œæˆå®éªŒè¯´æ˜æ–‡æ¡£çš„å„ä¸ªæ­¥éª¤å¹¶æ’°å†™æ­¤å®éªŒæŠ¥å‘Šï¼›
- èƒ½æ¼”ç¤ºå®éªŒè¿‡ç¨‹å¹¶é˜è¿°åŠŸèƒ½çš„ä¸»è¦ä»£ç æ¨¡å—ã€‚
- å®éªŒæŠ¥å‘Šè¯·çªå‡ºè‡ªå·±çš„**æƒ³æ³•**ã€**åšæ³•**ã€**å¿ƒå¾—ä½“ä¼š**ï¼›

## ä¸‰ å®éªŒç¯å¢ƒ

- Vs Codeã€Githubã€Typoraã€sm.msï¼›

- ç½‘ç«™ï¼š

  > [SM.MS]: https://sm.ms/
  > [PythonTutor]: https://pythontutor.com/visualize.html#mode=edit

## å›› å®éªŒå†…å®¹

### æ³¨æ„

æœ‰äº› doctest ä½¿ç”¨äº†è¿™äº›å‡½æ•°ï¼š

```python
from operator import add, mul

square = lambda x: x * x

identity = lambda x: x

triple = lambda x: 3 * x

increment = lambda x: x + 1
```

###  é—®é¢˜

#### What Would Python Displayï¼Ÿï¼ˆWWPDï¼‰

> æ³¨æ„ï¼šå¯¹æ‰€æœ‰çš„ WWPD é—®é¢˜ï¼Œå¦‚æœä½ è®¤ä¸ºç­”æ¡ˆæ˜¯ `<function...>`,  å°±æ•²å…¥ `Function` ;  æ˜¯é”™è¯¯ï¼Œå°±æ•²å…¥ 'Error'ï¼›æ˜¯ä»€ä¹ˆéƒ½ä¸æ˜¾ç¤ºï¼Œå°±æ•²å…¥ `Nothing`

##### é—®é¢˜1ï¼šWWPD: Lambda the Free

- ä»»åŠ¡æè¿°

  > ä½¿ç”¨ Ok æµ‹è¯•ä½ çš„çŸ¥è¯†ï¼Œå›ç­”ä¸‹é¢çš„â€œPythonä¼šæ˜¾ç¤ºä»€ä¹ˆâ€é—®é¢˜ï¼š
  >
  > ```shell
  > python3 ok --local -q lambda -u
  > ```
  >
  > æç¤ºä¸€ä¸‹,ä¸‹é¢çš„ä¸¤è¡Œä»£ç å†Pythonè§£é‡Šå™¨ä¸­æ‰§è¡Œæ—¶ä¸ä¼šæ˜¾ç¤ºä»»ä½•å†…å®¹ï¼š
  >
  > ```python
  > >>> x = None
  > >>> x
  > ```

  ```python
  >>> lambda x: x  # A lambda expression with one parameter x
  ______
  
  >>> a = lambda x: x  # Assigning the lambda function to the name a
  >>> a(5)
  ______
  
  >>> (lambda: 3)()  # Using a lambda expression as an operator in a call exp.
  ______
  
  >>> b = lambda x: lambda: x  # Lambdas can return other lambdas!
  >>> c = b(88)
  >>> c
  ______
  
  >>> c()
  ______
  
  >>> d = lambda f: f(4)  # They can have functions as arguments as well.
  >>> def square(x):
  ...     return x * x
  >>> d(square)
  ______
  ```

  ```python
  >>> x = None # remember to review the rules of WWPD given above!
  >>> x
  >>> lambda x: x
  ______
  ```

  ```python
  >>> z = 3
  >>> e = lambda x: lambda y: lambda: x + y + z
  >>> e(0)(1)()
  ______
  
  >>> f = lambda z: x + z
  >>> f(3)
  ______
  ```

  ```python
  >>> higher_order_lambda = lambda f: lambda x: f(x)
  >>> g = lambda x: x * x
  >>> higher_order_lambda(2)(g)  # Which argument belongs to which function call?
  ______
  
  >>> higher_order_lambda(g)(2)
  ______
  
  >>> call_thrice = lambda f: lambda x: f(f(f(x)))
  >>> call_thrice(lambda y: y + 1)(0)
  ______
  
  >>> print_lambda = lambda z: print(z)  # When is the return expression of a lambda expression executed?
  >>> print_lambda
  ______
  
  >>> one_thousand = print_lambda(1000)
  ______
  
  >>> one_thousand
  ______
  ```

- å®ç°æ­¥éª¤

  ```python
  >>> lambda x: x  # A lambda expression with one parameter x
  # ç»“æœ: æ–¹æ³•
  
  >>> a = lambda x: x  # Assigning the lambda function to the name a
  >>> a(5)
  # ç»“æœ: 5
  
  >>> (lambda: 3)()  # Using a lambda expression as an operator in a call exp.
  # ç»“æœ: 3
  
  >>> b = lambda x: lambda: x  # Lambdas can return other lambdas!
  >>> c = b(88)
  >>> c
  # ç»“æœ: Function
  
  >>> c()
  # ç»“æœ: 88
  
  >>> d = lambda f: f(4)  # They can have functions as arguments as well.
  >>> def square(x):
  ...     return x * x
  >>> d(square)
  # ç»“æœ: 16
  ```

  ```python
  >>> z = 3
  >>> e = lambda x: lambda y: lambda: x + y + z
  >>> e(0)(1)()
  # e(0): å‚æ•° x=0, è¿”å› lambda y: lambda: 0 + y + 3
  # e(0)(1): å‚æ•° y = 1, è¿”å› lambda: 0 + 1 + 3
  # e(0)(1)(): æ— å‚æ•°, è¿”å› 4
  # ç»“æœ: 4
  
  >>> f = lambda z: x + z
  >>> f(3)
  # f(3): å‚æ•° z = 3, x ä¸º NoneTypeï¼Œ æ— æ³•æ“ä½œ, Error
  # ç»“æœ: Error
  ```

  ```python
  >>> higher_order_lambda = lambda f: lambda x: f(x)
  >>> g = lambda x: x * x
  >>> higher_order_lambda(2)(g)  # Which argument belongs to which function call?
  # higher_order_lambda(2): å‚æ•° f = 2ï¼Œ f(x) Error: f ä¸ºæ•´å½¢, ä¸æ˜¯æ–¹æ³•
  # ç»“æœ: Error
  
  >>> higher_order_lambda(g)(2)
  # higher_order_lambda(g): å‚æ•° f ç»‘å®šæ–¹æ³• g, è¿”å› lambda x: g(x)
  # higher_order_lambda(g)(2): å‚æ•° x = 2, è¿”å› g(2), g(2): å‚æ•° x = 2, è¿”å› 4
  # ç»“æœ: 4
  
  >>> call_thrice = lambda f: lambda x: f(f(f(x)))
  >>> call_thrice(lambda y: y + 1)(0)
  # call_thrice(lambda y: y + 1): å‚æ•° f ç»‘å®š lambda y: y + 1, è¿”å›lambda x: f(f(f(x)))
  # call_thrice(lambda y: y + 1)(0): å‚æ•° x = 0, è¿”å› f(f(f(0)))
  # f(f(f(0))): f = lambda y: y + 1, f(0) è¿”å› 1, f(f(0)) è¿”å› 2ï¼Œ f(f(f(0))) è¿”å›3
  # ç»“æœ: 3
  
  >>> print_lambda = lambda z: print(z)  # When is the return expression of a lambda expression executed?
  >>> print_lambda
  # ç»“æœ: Function
  
  >>> one_thousand = print_lambda(1000)
  # ç»“æœ: 1000
  
  >>> one_thousand
  # ç»“æœ: Nothing
  ```

- æµ‹è¯•è¯´æ˜

  æµ‹è¯•ç»“æœï¼š

  ![](https://s2.loli.net/2022/03/26/AMRxsV5XZi3cDEz.png)


##### é—®é¢˜2ï¼šWWPD: Higher Order Functions

- ä»»åŠ¡æè¿°

  > ä½¿ç”¨ Ok æµ‹è¯•ä½ çš„çŸ¥è¯†ï¼Œå›ç­”ä¸‹é¢çš„â€œPythonä¼šæ˜¾ç¤ºä»€ä¹ˆâ€é—®é¢˜ï¼š
  >
  > ```
  > python3 ok --local -q hof-wwpd -u
  > ```

  ```python
  >>> def even(f):
  ...     def odd(x):
  ...         if x < 0:
  ...             return f(-x)
  ...         return f(x)
  ...     return odd
  >>> steven = lambda x: x
  >>> stewart = even(steven)
  >>> stewart
  ______
  
  >>> stewart(61)
  ______
  
  >>> stewart(-4)
  ______
  ```

  ```python
  >>> def cake():
  ...    print('beets')
  ...    def pie():
  ...        print('sweets')
  ...        return 'cake'
  ...    return pie
  >>> chocolate = cake()
  ______
  
  >>> chocolate
  ______
  
  >>> chocolate()
  ______
  
  >>> more_chocolate, more_cake = chocolate(), cake
  ______
  
  >>> more_chocolate
  ______
  
  >>> def snake(x, y):
  ...    if cake == more_cake:
  ...        return chocolate
  ...    else:
  ...        return x + y
  >>> snake(10, 20)
  ______
  
  >>> snake(10, 20)()
  ______
  
  >>> cake = 'cake'
  >>> snake(10, 20)
  ______
  ```

- å®ç°æ­¥éª¤

  ```python
  >>> def even(f):
  ...     def odd(x):
  ...         if x < 0:
  ...             return f(-x)
  ...         return f(x)
  ...     return odd
  >>> steven = lambda x: x
  >>> stewart = even(steven)
  >>> stewart
  # even(steven): å‚æ•° f ç»‘å®šæ–¹æ³• steven, è¿”å› odd æ–¹æ³•
  # stewart = even(steven): stewart ç»‘å®š odd æ–¹æ³•
  # ç»“æœ: Function
  
  >>> stewart(61) 
  # stewart(61): å‚æ•° x = 61, x > 0, è¿”å› f(61), å³ steven(61)
  # steven(61): å‚æ•° x = 61, è¿”å› 61
  # ç»“æœ: 61
  
  >>> stewart(-4)
  # ä¸ä¸Šä¸€ä¸ªå·®ä¸å¤š
  # ç»“æœ: 4
  ```

  ```python
  >>> def cake():
  ...    print('beets')
  ...    def pie():
  ...        print('sweets')
  ...        return 'cake'
  ...    return pie
  >>> chocolate = cake()
  # cake(): æ‰“å° beets, è¿”å› pie æ–¹æ³•
  # chocolate = cake(): chocolate ç»‘å®šæ–¹æ³• pie
  # ç»“æœ: beets
  
  >>> chocolate
  # å¯è§ä¸Š
  # ç»“æœ: Function
  
  >>> chocolate()
  # chocolate(): è°ƒç”¨ pie()æ–¹æ³•, æ‰“å° sweets, è¿”å› 'cake'
  # ç»“æœï¼šsweets
  # 	   'cake'
  
  >>> more_chocolate, more_cake = chocolate(), cake
  # more_chocolate, more_cake = chocolate(), cake: more_chocolate èµ‹å€¼ä¸ºæ–¹æ³• chocolate çš„è¿”å›å€¼, å³ 'cake', å¹¶æ‰“å° sweets, more_cake ç»‘å®šæ–¹æ³• cake
  # ç»“æœ: sweets
  
  >>> more_chocolate
  # å¯è§ä¸Š
  # ç»“æœ: 'cake'
  
  >>> def snake(x, y):
  ...    if cake == more_cake:
  ...        return chocolate
  ...    else:
  ...        return x + y
  >>> snake(10, 20)
  # snake(10, 20): å‚æ•° x = 10, y = 20, cake == more_cake, è¿”å› chocolate æ–¹æ³•
  # ç»“æœ: Function
  
  >>> snake(10, 20)()
  # snake(10, 20)(): æ— å‚æ•°, è°ƒç”¨ chocolate(), è°ƒç”¨ pie()æ–¹æ³•, æ‰“å° sweets, è¿”å› 'cake'
  # ç»“æœï¼šsweets
  # 	   'cake'
  
  >>> cake = 'cake'
  >>> snake(10, 20)
  # snake(10, 20): å‚æ•° x = 10, y = 20, cake != more_cake, è¿”å› 10 + 20 = 30
  # ç»“æœ: 30
  ```

- æµ‹è¯•è¯´æ˜

  æµ‹è¯•ç»“æœï¼š

  ![](https://s2.loli.net/2022/03/26/d5y8pmQOrowTV1c.png)

### Parsons é—®é¢˜

#### é—®é¢˜3ï¼šA Hop, a Skip, and a Jump

- ä»»åŠ¡æè¿°

  å®Œæˆ `hop` ï¼Œå®ƒå®ç°äº†å‡½æ•°  `f(x, y) = y`  çš„currying ç‰ˆæœ¬

  ```python
  def hop():
      """
      Calling hop returns a curried version of the function f(x, y) = y.
      >>> hop()(3)(2) # .Case 1
      2
      >>> hop()(3)(7) # .Case 2
      7
      >>> hop()(4)(7) # .Case 3
      7
      """
      "*** YOUR CODE HERE ***"
  ```
  
- å®ç°æ­¥éª¤

  1. è®¡æ•°ä»1å¼€å§‹ï¼Œå¹¶ä¸”ç»“å°¾è¦æ‰“å°1ï¼›
  2. whileæ¡ä»¶ä¸º n != 1ï¼Œæ“ä½œå†…å®¹ä¸ºä¸Šè¿°è¦æ±‚ä¸€è‡´ï¼›
  3. è¿”å›è®¡æ•°å€¼ï¼›

- å®ç°æ–¹æ³•

  ```python
  def hailstone(n):
      """Print the hailstone sequence starting at n and return its
      length.
  
      >>> a = hailstone(10)
      10
      5
      16
      8
      4
      2
      1
      >>> a
      7
      >>> b = hailstone(1)
      1
      >>> b
      1
      """
      "*** YOUR CODE HERE ***"
      count = 1
      while n != 1:
          print(n)
          if n % 2 == 0:
              n //= 2
          else:
              n = n * 3 + 1
          count += 1
      print(n)
      return count
  ```

- æµ‹è¯•è¯´æ˜

  æµ‹è¯•ç»“æœï¼š

  ![U4T_OQK~Y7P``WM9NHGM8DI.png](https://s2.loli.net/2022/03/19/jmcetG4uCB9rdio.png)

- å®ç°è¿‡ç¨‹

  ä»¥ä¸‹ä¸ºè¯¥ç¨‹åºçš„æ—¶é—´çº¿ï¼š

  ![_EVINBML_`U_R_XBX2F_9C1.png](https://s2.loli.net/2022/03/19/O987pIa1Wzlbx5q.png)

#### é—®é¢˜4ï¼š Product

- ä»»åŠ¡æè¿°

  é«˜é˜¶å‡½æ•°è¯¾å ‚ä¸Šä»‹ç»çš„ `summation(n, term)` å°† `term(1) + ... + term(n)` åŠ èµ·æ¥ã€‚ç¼–å†™ä¸€ä¸ªç±»ä¼¼çš„å‡½æ•° `product` ï¼Œè¿”å› `term(1) * ... * term(n)` ã€‚

  ```python
  def product(n, term):
      """Return the product of the first n terms in a sequence.
  
      n: a positive integer
      term:  a function that takes one argument to produce the term
  
      >>> product(3, identity)  # 1 * 2 * 3
      6
      >>> product(5, identity)  # 1 * 2 * 3 * 4 * 5
      120
      >>> product(3, square)    # 1^2 * 2^2 * 3^2
      36
      >>> product(5, square)    # 1^2 * 2^2 * 3^2 * 4^2 * 5^2
      14400
      >>> product(3, increment) # (1+1) * (2+1) * (3+1)
      24
      >>> product(3, triple)    # 1*3 * 2*3 * 3*3
      162
      """
      "*** YOUR CODE HERE ***"
  ```

  ä½¿ç”¨ Ok æµ‹è¯•ä½ çš„ä»£ç ï¼š

  ```
  python3 ok --local -q product
  ```

- å®ç°æ­¥éª¤

  - åœ¨ hw02.py æ–‡ä»¶å¼€å¤´å·²ç»å®šä¹‰äº† squareã€identityæ–¹æ³•ï¼Œä¼ å‚çš„æ—¶å€™termç›´æ¥è¢«å…¶ä¸­ä¸€ä¸ªæ–¹æ³•ç»‘å®šï¼Œåœ¨productæ–¹æ³•ä¸­ç›´æ¥ä½¿ç”¨termå°±è¡Œï¼›

- å®ç°æ–¹æ³•

  ```python
  def product(n, term):
      """Return the product of the first n terms in a sequence.
  
      n: a positive integer
      term:  a function that takes one argument to produce the term
  
      >>> product(3, identity)  # 1 * 2 * 3
      6
      >>> product(5, identity)  # 1 * 2 * 3 * 4 * 5
      120
      >>> product(3, square)    # 1^2 * 2^2 * 3^2
      36
      >>> product(5, square)    # 1^2 * 2^2 * 3^2 * 4^2 * 5^2
      14400
      >>> product(3, increment) # (1+1) * (2+1) * (3+1)
      24
      >>> product(3, triple)    # 1*3 * 2*3 * 3*3
      162
      """
      "*** YOUR CODE HERE ***"
      sum = 1
      while n > 0:
          sum *= term(n)
          n -= 1
      return sum
  ```

- æµ‹è¯•è¯´æ˜

  æµ‹è¯•ç»“æœï¼š

  ![P__D5G1T6W_P7_UPHI_6E11.png](https://s2.loli.net/2022/03/19/h8ErZXuMfNdYeWP.png)

- å®ç°è¿‡ç¨‹

  ä»¥ä¸‹ä¸ºè¯¥ç¨‹åºçš„æ—¶é—´çº¿ï¼š

  ![C3HVHDG`B_PWL__@L`13AIW.png](https://s2.loli.net/2022/03/19/nIXFBuULZbo3AHJ.png)

#### é—®é¢˜5ï¼š Accumulate

- ä»»åŠ¡æè¿°

  è®©æˆ‘ä»¬çœ‹çœ‹ `summation` å’Œ `product` æ˜¯å¦‚ä½•æˆä¸ºæ›´åŠ æ³›åŒ–çš„å‡½æ•° `accumulate` çš„å®ä¾‹çš„ï¼Œè¯·å®ç°è¯¥å‡½æ•°ã€‚

  ```python
  def accumulate(merger, start, n, term):
      """Return the result of merging the first n terms in a sequence and start.
      The terms to be merged are term(1), term(2), ..., term(n). merger is a
      two-argument commutative function.
  
      >>> accumulate(add, 0, 5, identity)  # 0 + 1 + 2 + 3 + 4 + 5
      15
      >>> accumulate(add, 11, 5, identity) # 11 + 1 + 2 + 3 + 4 + 5
      26
      >>> accumulate(add, 11, 0, identity) # 11
      11
      >>> accumulate(add, 11, 3, square)   # 11 + 1^2 + 2^2 + 3^2
      25
      >>> accumulate(mul, 2, 3, square)    # 2 * 1^2 * 2^2 * 3^2
      72
      >>> # 2 + (1^2 + 1) + (2^2 + 1) + (3^2 + 1)
      >>> accumulate(lambda x, y: x + y + 1, 2, 3, square)
      19
      >>> # ((2 * 1^2 * 2) * 2^2 * 2) * 3^2 * 2
      >>> accumulate(lambda x, y: 2 * x * y, 2, 3, square)
      576
      >>> accumulate(lambda x, y: (x + y) % 17, 19, 20, square)
      16
      """
      "*** YOUR CODE HERE ***"
  ```

  `accumulate` æœ‰å¦‚ä¸‹å‚æ•°ï¼š

  - `term` å’Œ `n`ï¼š ä¸ `summation` ï¼Œ`product` ä¸­çš„ä¸€æ ·
  - `merger`ï¼šå¸¦ä¸¤ä¸ªå‚æ•°çš„å‡½æ•°æŒ‡å®šäº†å½“å‰é¡¹æ˜¯å¦‚ä½•å’Œä¹‹å‰ç§¯ç´¯çš„é¡¹åˆå¹¶çš„
  - `start`ï¼šç§¯ç´¯çš„èµ·å§‹å€¼

  ä¾‹å¦‚ï¼Œ`accumulate(add, 11, 3, square)` çš„ç»“æœæ˜¯

  ```
  11 + square(1) + square(2) + square(3) = 25
  ```

  > æ³¨æ„ï¼šä½ å¯ä»¥å‡å®š `merger` æ»¡è¶³äº¤æ¢å¾‹ï¼Œå³ `merger(a, b) == merger(b, a)` ã€‚ä½†ä½ ä¸èƒ½å‡å®š `merger` æ˜¯ä»ä¸€ä¸ªå›ºå®šçš„å‡½æ•°é›†ä¸­é€‰å–çš„ï¼Œå¹¶ç¡¬ç¼–ç ï¼ˆhard-codeï¼‰åˆ°ç¨‹åºä¸­ã€‚

  å®ç° `accumulate` åï¼Œå±•ç¤ºä¸€ä¸‹å®šä¹‰ `summation` å’Œ `product` æ—¶ï¼Œå¦‚ä½•é€šè¿‡è°ƒç”¨å‡½æ•° `accumulate` å®ç°çš„ã€‚

  **é‡è¦**ï¼šä½ åº”è¯¥åœ¨ `summation_using_accumulate` å’Œ `product_using_accumulate` å®ç°ä¸­ç”¨ä¸€è¡Œä»£ç ï¼ˆåº”è¯¥æ—¶ä¸€ä¸ª `return` è¯­å¥ï¼‰ï¼Œä¼šæœ‰è¯­æ³•æ£€æŸ¥çš„ã€‚

  ä½¿ç”¨ Ok æµ‹è¯•ä½ çš„ä»£ç ï¼š

  ```
  python3 ok --local -q accumulate
  python3 ok --local -q summation_using_accumulate
  python3 ok --local -q product_using_accumulate
  ```

- å®ç°æ­¥éª¤

  - accumulate
    1. ä»¥ n ä¸ºå‚æ•°çš„ term æ–¹æ³•å¾—åˆ°åˆå§‹å€¼ï¼›
    2. å…ˆè®¡ç®— n æ‰€å¯¹åº”è¡¨è¾¾å¼çš„å€¼ï¼›
    3. æœ€åè¿”å›ç”± merge ç»‘å®šçš„æ–¹æ³•è®¡ç®—å¾—åˆ°çš„æœ€ç»ˆç»“æœï¼›
  - summation_using_accumulate
    1. åŠ æ³•è¿ç®—ï¼Œmerger ç»‘å®š add æ–¹æ³•ï¼Œstart å–0ï¼›
  - product_using_accumulate 
    1. ä¹˜æ³•è¿ç®—ï¼Œmerger ç»‘å®š mul æ–¹æ³•ï¼Œstartå–1ï¼›

- å®ç°æ–¹æ³•

  - accumulate

    ```python
    def accumulate(merger, start, n, term):
        """Return the result of merging the first n terms in a sequence and start.
        The terms to be merged are term(1), term(2), ..., term(n). merger is a
        two-argument commutative function.
    
        >>> accumulate(add, 0, 5, identity)  # 0 + 1 + 2 + 3 + 4 + 5
        15
        >>> accumulate(add, 11, 5, identity) # 11 + 1 + 2 + 3 + 4 + 5
        26
        >>> accumulate(add, 11, 0, identity) # 11
        11
        >>> accumulate(add, 11, 3, square)   # 11 + 1^2 + 2^2 + 3^2
        25
        >>> accumulate(mul, 2, 3, square)    # 2 * 1^2 * 2^2 * 3^2
        72
        >>> # 2 + (1^2 + 1) + (2^2 + 1) + (3^2 + 1)
        >>> accumulate(lambda x, y: x + y + 1, 2, 3, square)
        19
        >>> # ((2 * 1^2 * 2) * 2^2 * 2) * 3^2 * 2
        >>> accumulate(lambda x, y: 2 * x * y, 2, 3, square)
        576
        >>> accumulate(lambda x, y: (x + y) % 17, 19, 20, square)
        16
        """
        result = term(n)
        while n > 1:
            n -= 1
            result = merger(result, term(n)) 
        
        return merger(result, start)
    ```

  - summation_using_accumulate

    ```python
    def summation_using_accumulate(n, term):
        """Returns the sum: term(1) + ... + term(n), using accumulate.
    
        >>> summation_using_accumulate(5, square)
        55
        >>> summation_using_accumulate(5, triple)
        45
        >>> # You aren't expected to understand the code of this test.
        >>> # Check that the bodies of the functions are just return statements.
        >>> # If this errors, make sure you have removed the "***YOUR CODE HERE***".
        >>> import inspect, ast
        >>> [type(x).__name__ for x in ast.parse(inspect.getsource(summation_using_accumulate)).body[0].body]
        ['Expr', 'Return']
        """
        return accumulate(add, 0, n, term)
    ```

  - product_using_accumulate 

    ```python
    def product_using_accumulate(n, term):
        """Returns the product: term(1) * ... * term(n), using accumulate.
    
        >>> product_using_accumulate(4, square)
        576
        >>> product_using_accumulate(6, triple)
        524880
        >>> # You aren't expected to understand the code of this test.
        >>> # Check that the bodies of the functions are just return statements.
        >>> # If this errors, make sure you have removed the "***YOUR CODE HERE***".
        >>> import inspect, ast
        >>> [type(x).__name__ for x in ast.parse(inspect.getsource(product_using_accumulate)).body[0].body]
        ['Expr', 'Return']
        """
        return accumulate(mul, 1, n, term)
    ```

- æµ‹è¯•è¯´æ˜

  - accumulate æµ‹è¯•ç»“æœï¼š

    ![C`_BQOC3SBK2__X4YYJ_D@L.png](https://s2.loli.net/2022/03/19/Ex5sPuL8JVpDWTd.png)

  - summation_using_accumulate æµ‹è¯•ç»“æœï¼š

    ![X_2KAQY0K_9PD@A_6@H73G8.png](https://s2.loli.net/2022/03/19/5oVF9nwX1arPLRq.png)

  - product_using_accumulate æµ‹è¯•ç»“æœï¼š

    ![RCX2H_U3NU92KTEEME7D8OA.png](https://s2.loli.net/2022/03/19/QJ95rpeB6jA4vfM.png)

- å®ç°è¿‡ç¨‹

  ä»¥ä¸‹ä¸ºæ”¹ç¨‹åºçš„æ—¶é—´çº¿ï¼š

  ![_92_S_TIVPU_FEMN05_N`O8.png](https://s2.loli.net/2022/03/19/43NogZvUGrQcWkA.png)

### èµé‡‘é—®é¢˜

#### [1] You Again

- ä»»åŠ¡æè¿°

  > Fall 2019 MT1 Q3: [You Again](./61a-fa19-mt1.pdf) [Higher Order Functions] ï¼ˆç¬¬4é¡µç¬¬3é¢˜ï¼‰

  ```python
  Implement again, which takes a function f as an argument. The again function returns the smallest nonnegative integer n for which f(n) is equal to f(m) for some non-negative m that is less than n. Assume that f takes non-negative integers and returns the same value for at least two different non-negative arguments. 
  Constraints:
      â€¢ Lines numbered 2, 4, and 5 must begin with either while or if. 
      â€¢ Lines numbered 6 and 7 must contain either return or =.
  
  def parabola(x): 
      """
      A parabola function (for testing the again function).
      """
  	return (x-3) * (x-6)
  def vee(x): 
      """
      A V-shaped function (for testing the again function).
      """ 
      return abs(x-2)
  def again(f):
      """Return the smallest non-negative integer n such that f(n) == f(m) for some m < n.
  	>>> again(parabola) # parabola(4) == parabola(5)
      5
  	>>> again(vee)
      3
  	"""
  1 n = 1
  2 _________________________________________________________________________:
  3 m = 0 
  4 	_______________________________________________________________________:
  5 		___________________________________________________________________:
  6 			______________________________________________________________
  7 		___________________________________________________________________
  8 n = n + 1 
  ```

- å®ç°æ­¥éª¤

  - æœªçŸ¥å¾ªç¯æ¬¡æ•°ï¼Œä½¿ç”¨ while å¾ªç¯ï¼Œç”±äº må¿…é¡»åœ¨å¾ªç¯å†…éƒ¨ï¼Œæ•…ç»“æŸæ¡ä»¶å†™åœ¨å¾ªç¯å†…éƒ¨ï¼Œæ¡ä»¶ç¬¦åˆç›´æ¥è¿”å›ç»“æœï¼›
  - å¾ªç¯å†…ç»“æŸæ¡ä»¶æ˜¾ç„¶ä¸º f(m) == f(n)ï¼Œè¿”å›å€¼å– m, nä¸­æœ€å¤§å€¼ï¼›

- å®ç°æ–¹æ³•

  ```python
  def parabola(x):
      """
      A parabola function (for testing the again function).
      """
      return (x-3) * (x-6)
  
  
  def vee(x):
      """
      A V-shaped function (for testing the again function).
      """
      return abs(x-2)
  
  
  def again(f):
      """
      Return the smallest non-negative integer n such that f(n) == f(m) for some m < n.
      >>> again(parabola) # parabola(4) == parabola(5) 
      5
      >>> again(vee)
      3
      """
      n = 1
      while True:
          m = 0
          for m in range(1, n):
              if f(m) == f(n):
                  return max(m, n)
          n = n + 1
  ```

- æµ‹è¯•è¯´æ˜

  æµ‹è¯•ç»“æœï¼š

  ![_O6E_NWO9C`Z~YOB_ROEXUA.png](https://s2.loli.net/2022/03/19/poKkR1YmfJud6vr.png)

- å®ç°è¿‡ç¨‹

  ä»¥ä¸‹ä¸ºè¯¥ç¨‹åºæ—¶é—´çº¿ï¼š

  ![C9YFGU8~MKA`OKEM0_~K_M9.png](https://s2.loli.net/2022/03/19/uIeaOcQhBkNfgpr.png)

#### [2] Domain on the Range

- ä»»åŠ¡æè¿°

  > Spring 2021 MT1 Q4: [Domain on the Range](./61a-sp21-mt1.pdf) [Higher Order Functions] ï¼ˆç¬¬14é¡µç¬¬4é¢˜ï¼‰

  ```python
  The domain of a function is the set of all possible argument values, while the range of a function is the set of values that it can return. In this two part-question, you will implement higher-order functions to restrict the domain and range of other functions.
  (a) (4.0 points) restrict_domain
  Implement restrict_domain, a function that accepts three parameters (f, low_d, high_d) and returns a higher-order function that returns the same thing as f when given an argument between low_d and high_d, inclusive, and otherwise returns float("-inf"). 
  def restrict_domain(f, low_d, high_d): 
      """Returns a function that restricts the domain of F, 
      a function that takes a single argument x. 
      If x is not between LOW_D and HIGH_D (inclusive), 
      it returns -Infinity, but otherwise returns F(x).
      
  	>>> from math import sqrt 
  	>>> f = restrict_domain(sqrt, 1, 100) 
  	>>> f(25) 
  	5.0 
  	>>> f(-25) 
  	-inf 
  	>>> f(125)
      -inf 
  	>>> f(1)
      1.0 
  	>>> f(100)
      10.0 
      """
  	_________ 
      # (a)
  		_________ 
      	# (b)
  			_________ 
               # (c)
  		_________ 
          # (d)
  	return wrapper_method_name
  ```

- å®ç°æ­¥éª¤

  - å°† restrict_domain(sqrt, 1, 100) çš„è¿”å›å€¼ï¼Œå³ domain å‡½æ•°ç»‘å®šç»™ fï¼›
  - f(25) å³ domain(25)ï¼Œå°† 25 ä¸ low_d ä¸ high_d æ¯”è¾ƒï¼Œåœ¨èŒƒå›´å†…è¿”å› restrict_domain(sqrt, 1, 100) ä¸­çš„ sqrt(25)ï¼Œå¦åˆ™è¿”å› -infï¼›

- å®ç°æ–¹æ³•

  ```python
  def restrict_domain(f, low_d, high_d):
      """
      Returns a function that restricts the domain of F, 
      a function that takes a single argument x. 
      If x is not between LOW_D and HIGH_D (inclusive), 
      it returns -Infinity, but otherwise returns F(x).
  
      >>> from math import sqrt 
      >>> f = restrict_domain(sqrt, 1, 100) 
      >>> f(25) 
      5.0
      >>> f(-25) 
      -inf
      >>> f(125)
      -inf
      >>> f(1)
      1.0
      >>> f(100)
      10.0
      """
      def domain(x):
          if x >= low_d and x <= high_d:
              return f(x)
          else:
              return -inf
      return domain
  ```

- æµ‹è¯•è¯´æ˜

  æµ‹è¯•ç»“æœï¼š

  ![RDH2IA4F~J_QXZCOE_LL__6.png](https://s2.loli.net/2022/03/19/miQrDJ4XloFvVTd.png)

- å®ç°è¿‡ç¨‹

  ä»¥ä¸‹ä¸ºè¯¥ç¨‹åºæ—¶é—´çº¿ï¼š

  ![U_R__42ACD`C6_KGGJ17U0J.png](https://s2.loli.net/2022/03/20/BdZzaCKxWvHki2b.png)

#### [3] tik

- ä»»åŠ¡æè¿°

  > Fall 2021 MT1 Q1b: [tik](./61a-fa21-mt1.pdf) [Functions and Expressions] ï¼ˆç¬¬4é¡µç¬¬3ï¼ˆbï¼‰é¢˜ï¼‰

  ```python
  The function tik takes an argument tok and returns a function insta that takes an argument gram. The insta function prints tok and gram on the same line separated by a space and has no return statement. Its implementation has been omitted intentionally.
  def tik(tok):
      """Returns a function that takes gram and prints tok and gram on a line.
  	
  	>>> tik(5)(6) 
  	5 6
      """
  	def insta(gram): 
          ... # The implementation of this function has been omitted.
  	return insta
  i. (4.0 pt) What would the interactive Python interpreter display upon evaluating the expression:
  	tik(tik(5)(print(6)))(print(7))
  ```

- å®ç°æ­¥éª¤

  tik(5)(6)ï¼š

  ![CMOFIU__0~`E56_O85HZ580.png](https://s2.loli.net/2022/03/20/jsk51N4lYZAXmb6.png)

- å®ç°æ–¹æ³•

  ```python
  def tik(tok):
      """
      Returns a function that takes gram and prints tok and gram on a line.
      >>> tik(5)(6)
      5 6
      """
      def insta(gram):
          print(tok, gram)
      return insta
  ```

  ä½¿ç”¨ğŸ‘‡

  [PythonTutor]: https://pythontutor.com/visualize.html#mode=edit

- æµ‹è¯•è¯´æ˜

  tik(tik(5)(print(6)))(print(7)) æµ‹è¯•ç»“æœï¼š

  ```python
  6
  5 None
  7
  None None
  ```

  åˆ†æï¼š

  ![_1X2`U4B__~__U275Y_Q8P2.png](https://s2.loli.net/2022/03/20/g93HtGDOW2kipKA.png)

## äº” å®éªŒå¿ƒå¾—

> é€šè¿‡æœ¬æ¬¡å®éªŒï¼Œå­¦ä¹ å¹¶æŒæ¡äº†é«˜é˜¶å‡½æ•°çš„åŸºç¡€ï¼ŒåŒæ—¶é€šè¿‡åé¢ä¸‰ä¸ªèµé‡‘é—®é¢˜åŠ æ·±äº†å¯¹å…¶çš„ç†è§£ã€‚å¹¶é€šè¿‡åå¤ä½¿ç”¨PythonTutorï¼Œè®¤è¯†äº†é«˜é˜¶å‡½æ•°çš„è¿è¡Œè¿‡ç¨‹å¹¶åŠ ä»¥å®è·µè¿ç”¨ã€‚

