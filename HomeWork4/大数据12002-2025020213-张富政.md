## ![img](https://cnchen2000.oss-cn-shanghai.aliyuncs.com/img/logo.png)      è®¡ç®—æœºä¸äººå·¥æ™ºèƒ½å­¦é™¢ã€Šäººå·¥æ™ºèƒ½ç¨‹åºè®¾è®¡ã€‹å®éªŒæŠ¥å‘ŠğŸ“

| ä¸“ä¸š                 | å­¦å·                            | å§“å         |
| :------------------- | ------------------------------- | ------------ |
| æ•°æ®ç§‘å­¦ä¸å¤§æ•°æ®æŠ€æœ¯ | 2025020213                      | å¼ å¯Œæ”¿       |
| **è¯¾ç¨‹åç§°**         | **å®éªŒåç§°**                    | **å®Œæˆæ—¥æœŸ** |
| äººå·¥æ™ºèƒ½ç¨‹åºè®¾è®¡     | é«˜é˜¶å‡½æ•°ã€lambdaè¡¨è¾¾å¼ã€Curring | 2022.03.27   |



[TOC]

## ä¸€ å®éªŒç›®æ ‡

> - æŒæ¡Vs Codeã€githubçš„ä½¿ç”¨ï¼›
> - æŒæ¡ç¼–ç¨‹æ–‡æ¡£çš„æ’°å†™æ–¹æ³•ï¼›
> - å·©å›ºã€æŒæ¡é«˜é˜¶å‡½æ•°ã€lambdaè¡¨è¾¾å¼ã€curringï¼›

## äºŒ å®éªŒè¦æ±‚

> å®éªŒå®Œæˆçš„å…·ä½“è¦æ±‚è¯´æ˜ã€‚

- ä¸ªäººç‹¬ç«‹å®Œæˆï¼Œç§¯æåŠ¨æ‰‹ç¼–ç¨‹ï¼›
- é¼“åŠ±ä¸åŒå­¦äº¤æµï¼Œä½†ä¸èƒ½æŠ„è¢­æºç ï¼›
- èƒ½å®Œæˆå®éªŒè¯´æ˜æ–‡æ¡£çš„å„ä¸ªæ­¥éª¤å¹¶æ’°å†™æ­¤å®éªŒæŠ¥å‘Šï¼›
- èƒ½æ¼”ç¤ºå®éªŒè¿‡ç¨‹å¹¶é˜è¿°åŠŸèƒ½çš„ä¸»è¦ä»£ç æ¨¡å—ã€‚
- å®éªŒæŠ¥å‘Šè¯·çªå‡ºè‡ªå·±çš„**æƒ³æ³•**ã€**åšæ³•**ã€**å¿ƒå¾—ä½“ä¼š**ï¼›

## ä¸‰ å®éªŒç¯å¢ƒ

- Vs Codeã€Githubã€Typoraã€sm.msï¼›

- ç½‘ç«™ï¼š

  > [SM.MS]: https://sm.ms/
  > [PythonTutor]: https://pythontutor.com/visualize.html#mode=edit

## å›› å®éªŒå†…å®¹

###  é—®é¢˜

#### What Would Python Displayï¼Ÿï¼ˆWWPDï¼‰

> æ³¨æ„ï¼šå¯¹æ‰€æœ‰çš„ WWPD é—®é¢˜ï¼Œå¦‚æœä½ è®¤ä¸ºç­”æ¡ˆæ˜¯ `<function...>`,  å°±æ•²å…¥ `Function` ;  æ˜¯é”™è¯¯ï¼Œå°±æ•²å…¥ 'Error'ï¼›æ˜¯ä»€ä¹ˆéƒ½ä¸æ˜¾ç¤ºï¼Œå°±æ•²å…¥ `Nothing`

##### é—®é¢˜1ï¼šWWPD: Lambda the Free

- ä»»åŠ¡æè¿°

  > ä½¿ç”¨ Ok æµ‹è¯•ä½ çš„çŸ¥è¯†ï¼Œå›ç­”ä¸‹é¢çš„â€œPythonä¼šæ˜¾ç¤ºä»€ä¹ˆâ€é—®é¢˜ï¼š
  >
  > ```shell
  > python3 ok --local -q lambda -u
  > ```
  >
  > æç¤ºä¸€ä¸‹,ä¸‹é¢çš„ä¸¤è¡Œä»£ç å†Pythonè§£é‡Šå™¨ä¸­æ‰§è¡Œæ—¶ä¸ä¼šæ˜¾ç¤ºä»»ä½•å†…å®¹ï¼š
  >
  > ```python
  > >>> x = None
  > >>> x
  > ```

  ```python
  >>> lambda x: x  # A lambda expression with one parameter x
  ______
  
  >>> a = lambda x: x  # Assigning the lambda function to the name a
  >>> a(5)
  ______
  
  >>> (lambda: 3)()  # Using a lambda expression as an operator in a call exp.
  ______
  
  >>> b = lambda x: lambda: x  # Lambdas can return other lambdas!
  >>> c = b(88)
  >>> c
  ______
  
  >>> c()
  ______
  
  >>> d = lambda f: f(4)  # They can have functions as arguments as well.
  >>> def square(x):
  ...     return x * x
  >>> d(square)
  ______
  ```

  ```python
  >>> x = None # remember to review the rules of WWPD given above!
  >>> x
  >>> lambda x: x
  ______
  ```

  ```python
  >>> z = 3
  >>> e = lambda x: lambda y: lambda: x + y + z
  >>> e(0)(1)()
  ______
  
  >>> f = lambda z: x + z
  >>> f(3)
  ______
  ```

  ```python
  >>> higher_order_lambda = lambda f: lambda x: f(x)
  >>> g = lambda x: x * x
  >>> higher_order_lambda(2)(g)  # Which argument belongs to which function call?
  ______
  
  >>> higher_order_lambda(g)(2)
  ______
  
  >>> call_thrice = lambda f: lambda x: f(f(f(x)))
  >>> call_thrice(lambda y: y + 1)(0)
  ______
  
  >>> print_lambda = lambda z: print(z)  # When is the return expression of a lambda expression executed?
  >>> print_lambda
  ______
  
  >>> one_thousand = print_lambda(1000)
  ______
  
  >>> one_thousand
  ______
  ```

- å®ç°æ­¥éª¤

  ```python
  >>> lambda x: x  # A lambda expression with one parameter x
  # ç»“æœ: æ–¹æ³•
  
  >>> a = lambda x: x  # Assigning the lambda function to the name a
  >>> a(5)
  # ç»“æœ: 5
  
  >>> (lambda: 3)()  # Using a lambda expression as an operator in a call exp.
  # ç»“æœ: 3
  
  >>> b = lambda x: lambda: x  # Lambdas can return other lambdas!
  >>> c = b(88)
  >>> c
  # ç»“æœ: Function
  
  >>> c()
  # ç»“æœ: 88
  
  >>> d = lambda f: f(4)  # They can have functions as arguments as well.
  >>> def square(x):
  ...     return x * x
  >>> d(square)
  # ç»“æœ: 16
  ```

  ```python
  >>> z = 3
  >>> e = lambda x: lambda y: lambda: x + y + z
  >>> e(0)(1)()
  # e(0): å‚æ•° x=0, è¿”å› lambda y: lambda: 0 + y + 3
  # e(0)(1): å‚æ•° y = 1, è¿”å› lambda: 0 + 1 + 3
  # e(0)(1)(): æ— å‚æ•°, è¿”å› 4
  # ç»“æœ: 4
  
  >>> f = lambda z: x + z
  >>> f(3)
  # f(3): å‚æ•° z = 3, x ä¸º NoneTypeï¼Œ æ— æ³•æ“ä½œ, Error
  # ç»“æœ: Error
  ```

  ```python
  >>> higher_order_lambda = lambda f: lambda x: f(x)
  >>> g = lambda x: x * x
  >>> higher_order_lambda(2)(g)  # Which argument belongs to which function call?
  # higher_order_lambda(2): å‚æ•° f = 2ï¼Œ f(x) Error: f ä¸ºæ•´å½¢, ä¸æ˜¯æ–¹æ³•
  # ç»“æœ: Error
  
  >>> higher_order_lambda(g)(2)
  # higher_order_lambda(g): å‚æ•° f ç»‘å®šæ–¹æ³• g, è¿”å› lambda x: g(x)
  # higher_order_lambda(g)(2): å‚æ•° x = 2, è¿”å› g(2), g(2): å‚æ•° x = 2, è¿”å› 4
  # ç»“æœ: 4
  
  >>> call_thrice = lambda f: lambda x: f(f(f(x)))
  >>> call_thrice(lambda y: y + 1)(0)
  # call_thrice(lambda y: y + 1): å‚æ•° f ç»‘å®š lambda y: y + 1, è¿”å›lambda x: f(f(f(x)))
  # call_thrice(lambda y: y + 1)(0): å‚æ•° x = 0, è¿”å› f(f(f(0)))
  # f(f(f(0))): f = lambda y: y + 1, f(0) è¿”å› 1, f(f(0)) è¿”å› 2ï¼Œ f(f(f(0))) è¿”å›3
  # ç»“æœ: 3
  
  >>> print_lambda = lambda z: print(z)  # When is the return expression of a lambda expression executed?
  >>> print_lambda
  # ç»“æœ: Function
  
  >>> one_thousand = print_lambda(1000)
  # ç»“æœ: 1000
  
  >>> one_thousand
  # ç»“æœ: Nothing
  ```

- æµ‹è¯•è¯´æ˜

  æµ‹è¯•ç»“æœï¼š

  ![](https://s2.loli.net/2022/03/26/AMRxsV5XZi3cDEz.png)


##### é—®é¢˜2ï¼šWWPD: Higher Order Functions

- ä»»åŠ¡æè¿°

  > ä½¿ç”¨ Ok æµ‹è¯•ä½ çš„çŸ¥è¯†ï¼Œå›ç­”ä¸‹é¢çš„â€œPythonä¼šæ˜¾ç¤ºä»€ä¹ˆâ€é—®é¢˜ï¼š
  >
  > ```
  > python3 ok --local -q hof-wwpd -u
  > ```

  ```python
  >>> def even(f):
  ...     def odd(x):
  ...         if x < 0:
  ...             return f(-x)
  ...         return f(x)
  ...     return odd
  >>> steven = lambda x: x
  >>> stewart = even(steven)
  >>> stewart
  ______
  
  >>> stewart(61)
  ______
  
  >>> stewart(-4)
  ______
  ```

  ```python
  >>> def cake():
  ...    print('beets')
  ...    def pie():
  ...        print('sweets')
  ...        return 'cake'
  ...    return pie
  >>> chocolate = cake()
  ______
  
  >>> chocolate
  ______
  
  >>> chocolate()
  ______
  
  >>> more_chocolate, more_cake = chocolate(), cake
  ______
  
  >>> more_chocolate
  ______
  
  >>> def snake(x, y):
  ...    if cake == more_cake:
  ...        return chocolate
  ...    else:
  ...        return x + y
  >>> snake(10, 20)
  ______
  
  >>> snake(10, 20)()
  ______
  
  >>> cake = 'cake'
  >>> snake(10, 20)
  ______
  ```

- å®ç°æ­¥éª¤

  ```python
  >>> def even(f):
  ...     def odd(x):
  ...         if x < 0:
  ...             return f(-x)
  ...         return f(x)
  ...     return odd
  >>> steven = lambda x: x
  >>> stewart = even(steven)
  >>> stewart
  # even(steven): å‚æ•° f ç»‘å®šæ–¹æ³• steven, è¿”å› odd æ–¹æ³•
  # stewart = even(steven): stewart ç»‘å®š odd æ–¹æ³•
  # ç»“æœ: Function
  
  >>> stewart(61) 
  # stewart(61): å‚æ•° x = 61, x > 0, è¿”å› f(61), å³ steven(61)
  # steven(61): å‚æ•° x = 61, è¿”å› 61
  # ç»“æœ: 61
  
  >>> stewart(-4)
  # ä¸ä¸Šä¸€ä¸ªå·®ä¸å¤š
  # ç»“æœ: 4
  ```

  ```python
  >>> def cake():
  ...    print('beets')
  ...    def pie():
  ...        print('sweets')
  ...        return 'cake'
  ...    return pie
  >>> chocolate = cake()
  # cake(): æ‰“å° beets, è¿”å› pie æ–¹æ³•
  # chocolate = cake(): chocolate ç»‘å®šæ–¹æ³• pie
  # ç»“æœ: beets
  
  >>> chocolate
  # å¯è§ä¸Š
  # ç»“æœ: Function
  
  >>> chocolate()
  # chocolate(): è°ƒç”¨ pie()æ–¹æ³•, æ‰“å° sweets, è¿”å› 'cake'
  # ç»“æœï¼šsweets
  # 	   'cake'
  
  >>> more_chocolate, more_cake = chocolate(), cake
  # more_chocolate, more_cake = chocolate(), cake: more_chocolate èµ‹å€¼ä¸ºæ–¹æ³• chocolate çš„è¿”å›å€¼, å³ 'cake', å¹¶æ‰“å° sweets, more_cake ç»‘å®šæ–¹æ³• cake
  # ç»“æœ: sweets
  
  >>> more_chocolate
  # å¯è§ä¸Š
  # ç»“æœ: 'cake'
  
  >>> def snake(x, y):
  ...    if cake == more_cake:
  ...        return chocolate
  ...    else:
  ...        return x + y
  >>> snake(10, 20)
  # snake(10, 20): å‚æ•° x = 10, y = 20, cake == more_cake, è¿”å› chocolate æ–¹æ³•
  # ç»“æœ: Function
  
  >>> snake(10, 20)()
  # snake(10, 20)(): æ— å‚æ•°, è°ƒç”¨ chocolate(), è°ƒç”¨ pie()æ–¹æ³•, æ‰“å° sweets, è¿”å› 'cake'
  # ç»“æœï¼šsweets
  # 	   'cake'
  
  >>> cake = 'cake'
  >>> snake(10, 20)
  # snake(10, 20): å‚æ•° x = 10, y = 20, cake != more_cake, è¿”å› 10 + 20 = 30
  # ç»“æœ: 30
  ```

- æµ‹è¯•è¯´æ˜

  æµ‹è¯•ç»“æœï¼š

  ![](https://s2.loli.net/2022/03/27/ILTprqWzO8oD94g.png)

### Parsons é—®é¢˜

#### é—®é¢˜3ï¼šA Hop, a Skip, and a Jump

- ä»»åŠ¡æè¿°

  å®Œæˆ `hop` ï¼Œå®ƒå®ç°äº†å‡½æ•°  `f(x, y) = y`  çš„currying ç‰ˆæœ¬

  ```python
  def hop():
      """
      Calling hop returns a curried version of the function f(x, y) = y.
      >>> hop()(3)(2) # .Case 1
      2
      >>> hop()(3)(7) # .Case 2
      7
      >>> hop()(4)(7) # .Case 3
      7
      """
      "*** YOUR CODE HERE ***"
  ```
  
- å®ç°æ­¥éª¤

  ![](https://s2.loli.net/2022/03/27/yGxIKwEJ8CU2nm6.png)

- å®ç°æ–¹æ³•

  ```python
  def hop():
      """
      Calling hop returns a curried version of the function f(x, y) = y.
      >>> hop()(3)(2) # .Case 1
      2
      >>> hop()(3)(7) # .Case 2
      7
      >>> hop()(4)(7) # .Case 3
      7
      """
      "*** YOUR CODE HERE ***"
      def hop_1(x):
          def hop_2(y):
              print(y)
          return hop_2
      return hop_1
  ```

- æµ‹è¯•è¯´æ˜

  æµ‹è¯•ç»“æœï¼š

  ![](https://s2.loli.net/2022/03/27/lXzifRgpHwhJb6M.png)

- å®ç°è¿‡ç¨‹

  ä»¥ä¸‹ä¸ºè¯¥ç¨‹åºçš„æ—¶é—´çº¿ï¼š
  
  ![](https://s2.loli.net/2022/03/27/UfOa42z5rAwWhVD.png)

#### é—®é¢˜4ï¼š  Digit Index Factory

- ä»»åŠ¡æè¿°

  å®Œæˆå‡½æ•°  `digit_index_factory`ï¼Œæ¥å—ä¸¤ä¸ªæ•´æ•° `k` å’Œ `num` å¹¶è¿”å›ä¸€ä¸ªå‡½æ•°ã€‚è¿”å›å‡½æ•°æ²¡æœ‰å‚æ•°ï¼Œå¹¶è¾“å‡º `k` å’Œ `num` æœ€å³è¾¹æ•°ä½çš„åç§»é‡ï¼Œä¸¤ä¸ªæ•°çš„åç§»é‡æ˜¯æŒ‡ä¸¤ä¸ªæ•°ä¹‹é—´çš„æ­¥é•¿ã€‚ä¾‹å¦‚ï¼Œ`25` ä¸­ `2` å’Œ `5` çš„åç§»é‡æ˜¯ `1`ã€‚

  æ³¨æ„ `0` è¡¨ç¤ºæ²¡æœ‰æ•°ä½ï¼ˆå³ä½¿æ˜¯ `0` æœ¬èº«ï¼‰

  ```python
  def digit_index_factory(num, k):
      """
      Returns a function that takes no arguments, and outputs the offset
      between k and the rightmost digit of num. If k is not in num, then
      the returned function returns -1. Note that 0 is considered to
      contain no digits (not even 0).
      >>> digit_index_factory(34567, 4)() # .Case 1
      3
      >>> digit_index_factory(30001, 0)() # .Case 2
      1
      >>> digit_index_factory(999, 1)() # .Case 3
      -1
      >>> digit_index_factory(1234, 0)() # .Case 4
      -1
      """
      "*** YOUR CODE HERE ***"
  ```

- å®ç°æ­¥éª¤

  ![](https://s2.loli.net/2022/03/27/ySm6XhNAvVKb4qR.png)

- å®ç°æ–¹æ³•

  ```python
  def digit_index_factory(num, k):
      """
      Returns a function that takes no arguments, and outputs the offset
      between k and the rightmost digit of num. If k is not in num, then
      the returned function returns -1. Note that 0 is considered to
      contain no digits (not even 0).
      >>> digit_index_factory(34567, 4)() # .Case 1
      3
      >>> digit_index_factory(30001, 0)() # .Case 2
      1
      >>> digit_index_factory(999, 1)() # .Case 3
      -1
      >>> digit_index_factory(1234, 0)() # .Case 4
      -1
      """
      "*** YOUR CODE HERE ***"
      def digit(num = num, k = k):
          i = 0
          while num != 0:
              if num % 10 == k:
                  return i
              num //= 10
              i += 1
          return -1
      return digit
  ```

- æµ‹è¯•è¯´æ˜

  ![](https://s2.loli.net/2022/03/27/67B3h2WVUeZjsA4.png)

- å®ç°è¿‡ç¨‹

  ![](https://s2.loli.net/2022/03/27/NLFvkomdMUVJwrY.png)

### ç¼–ç¨‹é—®é¢˜

#### é—®é¢˜5ï¼šLambdas and Currying

- ä»»åŠ¡æè¿°

  ç¼–å†™å‡½æ•°` lambda_curry2`,  ä½¿ç”¨ lambda å¯¹ä»»æ„çš„åŒå‚æ•°å‡½æ•° curryingã€‚

  **ä½ çš„ç­”æ¡ˆåªèƒ½å†™åœ¨ return è¡Œ**ã€‚ ä½ å¯ä»¥è¯•ç€å…ˆå†™æ²¡æœ‰è¿™ä¸ªé™åˆ¶çš„ç­”æ¡ˆï¼Œç„¶åå†é‡å†™åˆ° return è¡Œã€‚

  > å¦‚æœè¯­æ³•æ£€æŸ¥ä¸èƒ½é€šè¿‡ï¼šç¡®ä¿ä½ å»æ‰äº† "***YOUR CODE HERE***" è¿™ä¸€è¡Œï¼Œè¿™æ ·è¯­æ³•æ£€æŸ¥å°±ä¸ä¼šè®¤ä¸ºå…¶æ˜¯å‡½æ•°çš„ä¸€éƒ¨åˆ†

  ```python
  def lambda_curry2(func):
      """
      Returns a Curried version of a two-argument function FUNC.
      >>> from operator import add, mul, mod
      >>> curried_add = lambda_curry2(add)
      >>> add_three = curried_add(3)
      >>> add_three(5)
      8
      >>> curried_mul = lambda_curry2(mul)
      >>> mul_5 = curried_mul(5)
      >>> mul_5(42)
      210
      >>> lambda_curry2(mod)(123)(10)
      3
      """
      "*** YOUR CODE HERE ***"
      return ______
  ```

  ä½¿ç”¨ Ok æµ‹è¯•ä½ çš„ä»£ç ï¼š

  ```python
  python3 ok --local -q lambda_curry2
  ```

- å®ç°æ­¥éª¤

  curried_add = lambda_curry2(add)ï¼šè°ƒç”¨ lambda_curry2 æ–¹æ³•ï¼Œå‚æ•° func ç»‘å®š add æ–¹æ³•ï¼Œè¿”å› lambda num_1: lambda num_2: func(num_1, num_2) ç»‘å®šç»™curried_addï¼›

  add_three = curried_add(3)ï¼šå‚æ•° num_1 = 3ï¼Œè¿”å›  lambda num_2: func(num_1, num_2)  ç»‘å®šç»™ add_threeï¼›

  add_three(5)ï¼šå‚æ•° num_2 = 5ï¼Œè¿”å› func(num_1, num_2)ï¼Œå³ add(3, 5) = 8ï¼›

- å®ç°æ–¹æ³•

  ```python
  def lambda_curry2(func):
      """
      Returns a Curried version of a two-argument function FUNC.
      >>> from operator import add, mul, mod
      >>> curried_add = lambda_curry2(add)
      >>> add_three = curried_add(3)
      >>> add_three(5)
      8
      >>> curried_mul = lambda_curry2(mul)
      >>> mul_5 = curried_mul(5)
      >>> mul_5(42)
      210
      >>> lambda_curry2(mod)(123)(10)
      3
      """
      # def func_1(num_1):
      #     def func_2(num_2):
      #         return func(num_1, num_2)
      #     return func_2
      # return func_1
      return lambda num_1: lambda num_2: func(num_1, num_2) 
  ```

- æµ‹è¯•è¯´æ˜

  æµ‹è¯•ç»“æœ:

  ![](https://s2.loli.net/2022/03/27/oLb6keuOR9WjnPU.png)

- å®ç°è¿‡ç¨‹

  ä»¥ä¸‹ä¸ºè¯¥ç¨‹åºæ—¶é—´çº¿:

  ![](https://s2.loli.net/2022/03/27/WYFvj3ZXduJqOco.png)

#### é—®é¢˜6ï¼š Count van Count

- ä»»åŠ¡æè¿°

  è€ƒè™‘ä¸‹é¢çš„å®ç°  `count_factors` å’Œ `count_primes`:

  ```python
  def count_factors(n):
      """Return the number of positive factors that n has.
      >>> count_factors(6)
      4   # 1, 2, 3, 6
      >>> count_factors(4)
      3   # 1, 2, 4
      """
      i = 1
      count = 0
      while i <= n:
          if n % i == 0:
              count += 1
          i += 1
      return count
  
  def count_primes(n):
      """Return the number of prime numbers up to and including n.
      >>> count_primes(6)
      3   # 2, 3, 5
      >>> count_primes(13)
      6   # 2, 3, 5, 7, 11, 13
      """
      i = 1
      count = 0
      while i <= n:
          if is_prime(i):
              count += 1
          i += 1
      return count
  
  def is_prime(n):
      return count_factors(n) == 2 # only factors are 1 and n
  ```

  å®ç°çœ‹ä¸Šå»å¾ˆç›¸ä¼¼ï¼ç¼–å†™å‡½æ•° `count_cond` æ¥æ³›åŒ–è¿™ä¸ªé€»è¾‘ï¼Œæ¥å—åŒå‚æ•°çš„ predicate å‡½æ•° `condition(n, i)` ï¼Œ `count_cond` è¿”å›ä¸€ä¸ªå‚æ•° `n` çš„å‡½æ•°ï¼Œå‡½æ•°è°ƒç”¨æ—¶ç»Ÿè®¡ä» 1 åˆ° `n` æ‰€æœ‰æ»¡è¶³æ¡ä»¶ `condition` çš„æ•°å­—ä¸ªæ•°ã€‚ 

  ```python
  def count_cond(condition):
      """Returns a function with one parameter N that counts all the numbers from
      1 to N that satisfy the two-argument predicate function Condition, where
      the first argument for Condition is N and the second argument is the
      number from 1 to N.
  
      >>> count_factors = count_cond(lambda n, i: n % i == 0)
      >>> count_factors(2)   # 1, 2
      2
      >>> count_factors(4)   # 1, 2, 4
      3
      >>> count_factors(12)  # 1, 2, 3, 4, 6, 12
      6
  
      >>> is_prime = lambda n, i: count_factors(i) == 2
      >>> count_primes = count_cond(is_prime)
      >>> count_primes(2)    # 2
      1
      >>> count_primes(3)    # 2, 3
      2
      >>> count_primes(4)    # 2, 3
      2
      >>> count_primes(5)    # 2, 3, 5
      3
      >>> count_primes(20)   # 2, 3, 5, 7, 11, 13, 17, 19
      8
      """
      "*** YOUR CODE HERE ***"
  ```

  ä½¿ç”¨ Ok æµ‹è¯•ä½ çš„ä»£ç ï¼š

  ```
  python3 ok --local -q count_cond
  ```

- å®ç°æ­¥éª¤

  count_factors = count_cond(lambda n, i: n % i == 0)ï¼šå‚æ•° condition ç»‘å®š lambda n, i: n % i == 0ï¼Œcount_factors ç»‘å®šè¿”å›æ–¹æ³• funcï¼›

  count_factors(2)ï¼šâ€”â€”> func(2)ï¼Œå‚æ•° n = 2ï¼Œå¼€å§‹è®¡æ•°ï¼Œæœ€åè¿”å›è®¡æ•°ç»“æœï¼›

- å®ç°æ–¹æ³•

  ```python
  def count_cond(condition):
      """Returns a function with one parameter N that counts all the numbers from
      1 to N that satisfy the two-argument predicate function Condition, where
      the first argument for Condition is N and the second argument is the
      number from 1 to N.
  
      >>> count_factors = count_cond(lambda n, i: n % i == 0)
      >>> count_factors(2)   # 1, 2
      2
      >>> count_factors(4)   # 1, 2, 4
      3
      >>> count_factors(12)  # 1, 2, 3, 4, 6, 12
      6
  
      >>> is_prime = lambda n, i: count_factors(i) == 2
      >>> count_primes = count_cond(is_prime)
      >>> count_primes(2)    # 2
      1
      >>> count_primes(3)    # 2, 3
      2
      >>> count_primes(4)    # 2, 3
      2
      >>> count_primes(5)    # 2, 3, 5
      3
      >>> count_primes(20)   # 2, 3, 5, 7, 11, 13, 17, 19
      8
      """
      def func(n):
          count = 0
          i = 1
          while i <= n:
              if condition(n, i):
                  count += 1
              i += 1
          return count
      return func
  ```

- æµ‹è¯•è¯´æ˜

  æµ‹è¯•ç»“æœï¼š

  ![](https://s2.loli.net/2022/03/27/SlgAp6OaCemM73E.png)

- å®ç°è¿‡ç¨‹

  ç¨‹åºæ—¶é—´çº¿ï¼š

  ![](https://s2.loli.net/2022/03/27/zSflJRbyhwUs4CY.png)

### é€‰åšé—®é¢˜

#### é—®é¢˜7ï¼šComposite Identity Function

- ä»»åŠ¡æè¿°

  ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œæ¥å—ä¸¤ä¸ªå•å‚æ•°å‡½æ•° `f` å’Œ `g`ï¼Œå¹¶è¿”å›å¦ä¸€ä¸ªå•å‚æ•° `x` çš„**å‡½æ•°**ã€‚å¦‚æœ `f(g(x))`  ç­‰äº  `g(f(x))`ï¼Œåˆ™å‡½æ•°è¿”å› Trueã€‚ä½ å¯ä»¥å‡å®š `g(x)` çš„è¾“å‡ºæ˜¯ `f` çš„æœ‰æ•ˆè¾“å…¥ï¼Œåä¹‹äº¦ç„¶ã€‚å°è¯•ä½¿ç”¨ä¸‹é¢å®šä¹‰çš„å‡½æ•° `composer` æ¥è¿›è¡Œæ›´å¤šçš„ é«˜é˜¶å‡½æ•°ç»ƒä¹ ã€‚

  ```python
  def composer(f, g):
      """Return the composition function which given x, computes f(g(x)).
  
      >>> add_one = lambda x: x + 1        # adds one to x
      >>> square = lambda x: x**2
      >>> a1 = composer(square, add_one)   # (x + 1)^2
      >>> a1(4)
      25
      >>> mul_three = lambda x: x * 3      # multiplies 3 to x
      >>> a2 = composer(mul_three, a1)    # ((x + 1)^2) * 3
      >>> a2(4)
      75
      >>> a2(5)
      108
      """
      return lambda x: f(g(x))
  
  def composite_identity(f, g):
      """
      Return a function with one parameter x that returns True if f(g(x)) is
      equal to g(f(x)). You can assume the result of g(x) is a valid input for f
      and vice versa.
  
      >>> add_one = lambda x: x + 1        # adds one to x
      >>> square = lambda x: x**2
      >>> b1 = composite_identity(square, add_one)
      >>> b1(0)                            # (0 + 1)^2 == 0^2 + 1
      True
      >>> b1(4)                            # (4 + 1)^2 != 4^2 + 1
      False
      """
      "*** YOUR CODE HERE ***"
  ```

  ä½¿ç”¨ Ok æµ‹è¯•ä½ çš„ä»£ç ï¼š

  ```
  python3 ok --local -q composite_identity
  ```

- å®ç°æ­¥éª¤

  ![](https://s2.loli.net/2022/03/27/e1B3jpZVfOMwKnS.png)

- å®ç°æ–¹æ³•

  ```python
  def composer(f, g):
      """Return the composition function which given x, computes f(g(x)).
  
      >>> add_one = lambda x: x + 1        # adds one to x
      >>> square = lambda x: x**2
      >>> a1 = composer(square, add_one)   # (x + 1)^2
      >>> a1(4)
      25
      >>> mul_three = lambda x: x * 3      # multiplies 3 to x
      >>> a2 = composer(mul_three, a1)    # ((x + 1)^2) * 3
      >>> a2(4)
      75
      >>> a2(5)
      108
      """
      return lambda x: f(g(x))
  
  
  def composite_identity(f, g):
      """
      Return a function with one parameter x that returns True if f(g(x)) is
      equal to g(f(x)). You can assume the result of g(x) is a valid input for f
      and vice versa.
  
      >>> add_one = lambda x: x + 1        # adds one to x
      >>> square = lambda x: x**2
      >>> b1 = composite_identity(square, add_one)
      >>> b1(0)                            # (0 + 1)^2 == 0^2 + 1
      True
      >>> b1(4)                            # (4 + 1)^2 != 4^2 + 1
      False
      """
      def judge(x):
          if composer(f, g)(x) == composer(g, f)(x):
              return True
          return False
      return judge
  ```

- æµ‹è¯•è¯´æ˜

  æµ‹è¯•ç»“æœï¼š

  ![](https://s2.loli.net/2022/03/27/Ig5ZBsyQJS4RHGF.png)

- å®ç°è¿‡ç¨‹

  ç¨‹åºæ—¶é—´çº¿ï¼š

  ![](https://s2.loli.net/2022/03/27/DjPN28akSvOAM1s.png)

#### é—®é¢˜8ï¼š I Heard You Liked Functions...

- ä»»åŠ¡æè¿°

  å®šä¹‰å‡½æ•° `cycle` ï¼Œæ¥å—ä¸‰ä¸ªå‚æ•° `f1` , `f2` , `f3` ã€‚`cycle` å°†è¿”å›å¦ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°æ¥å—ä¸€ä¸ªæ•´å‹å‚æ•° `n` å¹¶è¿”å›å¦å¤–ä¸€ä¸ªå‡½æ•°ï¼Œè€Œæœ€åè¿™ä¸ªå‡½æ•°åº”è¯¥æ¥å—ä¸€ä¸ªå‚æ•° `x` å¹¶å¾ªç¯åœ°å°†  `f1` , `f2` , `f3`  åº”ç”¨åˆ° `x` ä¸Šã€‚ä¸‹é¢æ˜¯ å¯¹äº `n` çš„ä¸€äº›å€¼ï¼Œæœ€ç»ˆçš„å‡½æ•°åº”è¯¥å¯¹ `x` åšä»€ä¹ˆï¼š

  - `n = 0`, è¿”å› `x`
  - `n = 1`, åº”ç”¨ `f1` åˆ° `x`, æˆ–è€…è¿”å› `f1(x)`
  - `n = 2`, åº”ç”¨ `f1` åˆ° `x` ç„¶ååº”ç”¨ `f2` åˆ°åˆšæ‰çš„ç»“æœä¸Šï¼Œæˆ–è€…è¿”å› `f2(f1(x))`
  - `n = 3`, åº”ç”¨ `f1` åˆ° `x`, `f2` åˆ° åº”ç”¨ `f1` çš„ç»“æœ, ç„¶å `f3` åˆ° åº”ç”¨ `f2` çš„ç»“æœ, æˆ–è€… `f3(f2(f1(x)))`
  - `n = 4`, é‡æ–°å¼€å§‹è¿™ä¸ªå¾ªç¯åº”ç”¨ï¼Œåº”ç”¨ `f1`, ç„¶å `f2`, ç„¶å `f3`, ç„¶ååˆ `f1` , æˆ–è€… `f1(f3(f2(f1(x))))`
  - ç»§ç»­ä¸‹å».

  > æç¤ºï¼šæœ€å¤šçš„å·¥ä½œåœ¨æœ€é‡Œé¢åµŒå¥—çš„å‡½æ•°ä¸­ã€‚


  ```python
  def cycle(f1, f2, f3):
      """Returns a function that is itself a higher-order function.
  
      >>> def add1(x):
      ...     return x + 1
      >>> def times2(x):
      ...     return x * 2
      >>> def add3(x):
      ...     return x + 3
      >>> my_cycle = cycle(add1, times2, add3)
      >>> identity = my_cycle(0)
      >>> identity(5)
      5
      >>> add_one_then_double = my_cycle(2)
      >>> add_one_then_double(1)
      4
      >>> do_all_functions = my_cycle(3)
      >>> do_all_functions(2)
      9
      >>> do_more_than_a_cycle = my_cycle(4)
      >>> do_more_than_a_cycle(2)
      10
      >>> do_two_cycles = my_cycle(6)
      >>> do_two_cycles(1)
      19
      """
      "*** YOUR CODE HERE ***"
  ```

  ä½¿ç”¨Okæµ‹è¯•ä½ çš„ä»£ç 

  ```
  python3 ok --local -q cycle
  ```

- å®ç°æ­¥éª¤

  ![](https://s2.loli.net/2022/03/27/hc5HEwbBKnkfZlz.png)

- å®ç°æ–¹æ³•

  ```python
  def cycle(f1, f2, f3):
      """Returns a function that is itself a higher-order function.
  
      >>> def add1(x):
      ...     return x + 1
      >>> def times2(x):
      ...     return x * 2
      >>> def add3(x):
      ...     return x + 3
      >>> my_cycle = cycle(add1, times2, add3)
      >>> identity = my_cycle(0)
      >>> identity(5)
      5
      >>> add_one_then_double = my_cycle(2)
      >>> add_one_then_double(1)
      4
      >>> do_all_functions = my_cycle(3)
      >>> do_all_functions(2)
      9
      >>> do_more_than_a_cycle = my_cycle(4)
      >>> do_more_than_a_cycle(2)
      10
      >>> do_two_cycles = my_cycle(6)
      >>> do_two_cycles(1)
      19
      """
      def func(n):
          def func_final(x):
              for i in range(1, n + 1):
                  if i % 3 == 1:
                      x = f1(x)
                  elif i % 3 == 2:
                      x = f2(x)
                  else:
                      x = f3(x)
              return x
          return func_final
      return func
  ```

- æµ‹è¯•è¯´æ˜

  æµ‹è¯•ç»“æœï¼š

  ![](https://s2.loli.net/2022/03/27/jyuJLOZ96WFt2xD.png)

- å®ç°è¿‡ç¨‹

  ç¨‹åºæ—¶é—´çº¿ï¼š

  ![](https://s2.loli.net/2022/03/27/udXYkzNerAsClbL.png)


## äº” å®éªŒå¿ƒå¾—

> é€šè¿‡æœ¬æ¬¡å®éªŒï¼Œå·©å›ºå¹¶æŒæ¡äº†é«˜é˜¶å‡½æ•°ã€lambdaå‡½æ•°å’ŒCurringï¼ŒåŒæ—¶é€šè¿‡æœ€åçš„ä¸¤ä¸ªé€‰åšé—®é¢˜åŠ æ·±äº†å¯¹å…¶çš„ç†è§£ã€‚å¹¶é€šè¿‡ç†Ÿç»ƒè¿ç”¨PythonTutorï¼Œäº†è§£äº†Curringçš„å…·ä½“å®ç°è¿‡ç¨‹å¹¶åŠ ä»¥å®è·µè¿ç”¨ã€‚

